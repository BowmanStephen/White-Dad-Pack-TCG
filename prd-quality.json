{
  "name": "DadDeckâ„¢ - Code Quality Fixes",
  "description": "Code simplicity and quality improvements from code review",
  "branchName": "fix/code-quality",
  "userStories": [
    {
      "id": "US101",
      "title": "Code Quality - Consolidate RARITY_ORDER Constant",
      "description": "As a developer, I want a single source of truth for rarity ordering, so I avoid maintenance issues and inconsistent behavior.",
      "acceptanceCriteria": [
        "Export canonical RARITY_ORDER from src/types/index.ts",
        "Remove duplicate definition from src/stores/collection.ts:34",
        "Remove duplicate definition from src/lib/pack/generator.ts:118",
        "Remove duplicate definition from src/stores/crafting.ts:340",
        "Update all imports to use canonical version",
        "Run tests to ensure no regressions"
      ],
      "priority": 1,
      "passes": false,
      "labels": [
        "code-quality",
        "refactor",
        "dry"
      ]
    },
    {
      "id": "US102",
      "title": "Code Quality - Fix Cross-Store Communication Pattern",
      "description": "As a developer, I want proper store imports instead of window object pollution, so I maintain type safety and follow best practices. NOTE: There is a screenshot file 'Screenshot 2026-01-17 at 2.51.08 PM.png' in the project directory that the AI model cannot read. This file should be ignored or removed before running Ralph to avoid errors.",
      "acceptanceCriteria": [
        "Remove window.__dailyRewardsState from src/stores/daily-rewards.ts:541-547",
        "Update src/stores/achievements.ts:186-227 to import dailyRewards store directly",
        "Create a proper getter function for streak state if needed",
        "Ensure all achievement checks work correctly",
        "Run tests to ensure no regressions"
      ],
      "priority": 1,
      "passes": false,
      "labels": [
        "code-quality",
        "refactor",
        "type-safety"
      ]
    },
    {
      "id": "US103",
      "title": "Code Quality - Create Shared Date Encoder Utility",
      "description": "As a developer, I want a reusable date encoder utility, so I eliminate ~150 lines of duplicated code.",
      "acceptanceCriteria": [
        "Create src/lib/utils/encoders.ts with createDateEncoder<T>() utility",
        "Refactor src/stores/collection.ts:6-31 to use shared encoder",
        "Refactor src/stores/achievements.ts:13-31 to use shared encoder",
        "Refactor src/stores/battle.ts:41-61 to use shared encoder",
        "Refactor src/stores/daily-rewards.ts:94-117 to use shared encoder",
        "Refactor src/stores/crafting.ts:66-113 to use shared encoder",
        "Run tests to ensure persistence still works"
      ],
      "priority": 1,
      "passes": false,
      "labels": [
        "code-quality",
        "refactor",
        "dry"
      ]
    },
    {
      "id": "US104",
      "title": "Code Quality - Simplify svelte-helpers.ts",
      "description": "As a developer, I want efficient store subscriptions, so I don't trigger unnecessary re-reads on every store change.",
      "acceptanceCriteria": [
        "Evaluate if src/lib/stores/svelte-helpers.ts is still needed",
        "If needed, refactor to use Nanostores computed() for derived values",
        "If not needed, remove and update any components using it",
        "Document the decision in code comments"
      ],
      "priority": 2,
      "passes": false,
      "labels": [
        "code-quality",
        "refactor",
        "performance"
      ]
    },
    {
      "id": "US105",
      "title": "Code Quality - Refactor PackOpener Dynamic Imports",
      "description": "As a developer, I want cleaner store imports in PackOpener, so code is more readable and maintainable.",
      "acceptanceCriteria": [
        "Import stores at component level in src/components/pack/PackOpener.svelte",
        "Guard usage with onMount for SSR safety",
        "Remove 8 dynamic import patterns (lines 37-97)",
        "Ensure pack opening still works correctly"
      ],
      "priority": 2,
      "passes": false,
      "labels": [
        "code-quality",
        "refactor",
        "svelte"
      ]
    },
    {
      "id": "US106",
      "title": "Code Quality - Create Achievement Factory Function",
      "description": "As a developer, I want a factory function for similar achievements, so I reduce verbose repetitive definitions.",
      "acceptanceCriteria": [
        "Create createStreakAchievement() factory in src/stores/achievements.ts",
        "Refactor daily streak achievements (lines 180-264) to use factory",
        "Consider factory functions for other achievement patterns",
        "Maintain type safety"
      ],
      "priority": 2,
      "passes": false,
      "labels": [
        "code-quality",
        "refactor",
        "dry"
      ]
    },
    {
      "id": "US107",
      "title": "Code Quality - Optimize Collection Stats Computation",
      "description": "As a developer, I want cached rarity counts, so I avoid iterating all packs/cards on every stats call.",
      "acceptanceCriteria": [
        "Add cached counts to collection metadata",
        "Update counts incrementally when packs are added",
        "Refactor computeRarityCounts() in src/stores/collection.ts:92-109",
        "Run performance tests to verify improvement"
      ],
      "priority": 3,
      "passes": false,
      "labels": [
        "code-quality",
        "performance",
        "optimization"
      ]
    },
    {
      "id": "US108",
      "title": "Code Quality - Split Types File",
      "description": "As a developer, I want types file split by domain, so IDE performance improves and navigation is easier.",
      "acceptanceCriteria": [
        "Create src/types/core.ts for Card, Pack, Rarity types",
        "Create src/types/analytics.ts for Analytics event types",
        "Create src/types/crafting.ts for Crafting types",
        "Move constants to src/data/configs.ts",
        "Update src/types/index.ts to re-export from new files",
        "Update all imports project-wide"
      ],
      "priority": 3,
      "passes": false,
      "labels": [
        "code-quality",
        "refactor",
        "types"
      ]
    },
    {
      "id": "US110",
      "title": "Code Quality - Fix Rate Limiter Type Error",
      "description": "As a developer, I want to fix the TypeScript type error in rate limiter where 'windowMs' property doesn't exist on type 'never'.",
      "acceptanceCriteria": [
        "Fix the type error in src/lib/security/rate-limiter.ts:147",
        "Ensure rate limiting still works correctly",
        "Run tests to verify fix"
      ],
      "priority": 1,
      "passes": false,
      "labels": [
        "code-quality",
        "fix",
        "typescript"
      ]
    },
    {
      "id": "US111",
      "title": "Code Quality - Remove Screenshot Files",
      "description": "As a developer, I want to remove screenshot files that cause AI model read errors (e.g., 'Screenshot 2026-01-17 at 2.51.08 PM.png').",
      "acceptanceCriteria": [
        "Remove all screenshot files from project root",
        "Update .gitignore to ignore *.png screenshots",
        "Verify no AI read errors in logs"
      ],
      "priority": 1,
      "passes": false,
      "labels": [
        "code-quality",
        "cleanup"
      ]
    },
    {
      "id": "US112",
      "title": "Code Quality - Add .gitignore for .DS_Store",
      "description": "As a developer, I want to add .DS_Store to .gitignore to prevent commit noise on macOS.",
      "acceptanceCriteria": [
        "Add .DS_Store to .gitignore",
        "Add .DS_Store/** pattern to ignore nested directories",
        "Verify git status is clean"
      ],
      "priority": 2,
      "passes": false,
      "labels": [
        "git",
        "cleanup"
      ]
    },
    {
      "id": "US113",
      "title": "Code Quality - Supress Test Console Warnings",
      "description": "As a developer, I want to suppress noisy console warnings during test runs (e.g., '[Analytics] Event not tracked').",
      "acceptanceCriteria": [
        "Identify sources of console warnings in tests",
        "Suppress or redirect warnings appropriately",
        "Add environment variable to disable warnings in test mode",
        "Keep warnings enabled in development mode"
      ],
      "priority": 2,
      "passes": false,
      "labels": [
        "code-quality",
        "testing"
      ]
    },
    {
      "id": "US114",
      "title": "Code Quality - Remove Console.log Statements",
      "description": "As a developer, I want to remove console.log statements from production code, keeping only error logging.",
      "acceptanceCriteria": [
        "Search for console.log in src/ directory",
        "Replace with proper logger or remove entirely",
        "Add debug flag for conditional logging",
        "Ensure error handling still logs to console"
      ],
      "priority": 2,
      "passes": false,
      "labels": [
        "code-quality",
        "refactor",
        "logging"
      ]
    },
    {
      "id": "US115",
      "title": "Code Quality - Standardize JSDoc Format",
      "description": "As a developer, I want to standardize JSDoc comment format across the codebase for consistency.",
      "acceptanceCriteria": [
        "Document JSDoc style guidelines in AGENTS.md or separate file",
        "Apply standard format to inconsistent JSDoc comments",
        "Run linter to enforce JSDoc standards"
      ],
      "priority": 2,
      "passes": false,
      "labels": [
        "code-quality",
        "documentation"
      ]
    },
    {
      "id": "US116",
      "title": "Code Quality - Remove Unused Imports",
      "description": "As a developer, I want to remove unused import statements to reduce bundle size and improve maintainability.",
      "acceptanceCriteria": [
        "Identify unused imports using IDE or linter",
        "Remove unused imports from files",
        "Update imports if file was actually using them"
      ],
      "priority": 2,
      "passes": false,
      "labels": [
        "code-quality",
        "refactor",
        "bundle"
      ]
    },
    {
      "id": "US117",
      "title": "Code Quality - Add Unit Tests for Utilities",
      "description": "As a developer, I want to add unit tests for utility functions in src/lib/utils/ to ensure code quality and catch regressions.",
      "acceptanceCriteria": [
        "Create tests/utilities.test.ts file",
        "Add tests for existing functions (random, errors, encoding)",
        "Ensure tests cover edge cases and error scenarios",
        "Run tests and verify all pass"
      ],
      "priority": 2,
      "passes": false,
      "labels": [
        "code-quality",
        "testing"
      ]
    }
  ],
  "metadata": {
    "createdAt": "2026-01-17T19:40:00Z",
    "version": "1.0.0",
    "updatedAt": "2026-01-17T20:47:48.358Z"
  }
}