---
import BaseLayout from '../layouts/BaseLayout.astro';
import CollectionManager from '../components/collection/CollectionManager.svelte';
import CollectionStats from '../components/collection/CollectionStats.svelte';
import Gallery from '../components/collection/Gallery.svelte';
import PackHistoryPanel from '../components/collection/PackHistoryPanel.svelte';
import Navigation from '../components/common/Navigation.svelte';
import SettingsModal from '../components/common/SettingsModal.svelte';
import ErrorBoundary from '../components/common/ErrorBoundary.svelte';

// Enhanced SEO for collection page
const title = "My Collection - DadDeck Trading Card Game";
const description = "View and manage your complete DadDeck trading card collection. Track all opened packs, discover rare holographic cards, and organize your dad-themed card inventory in this free browser TCG simulator.";
const collectionPageURL = new URL('/collection', Astro.site).href;
const imageURL = new URL('/og-image.png', Astro.site).href;

// CollectionPage structured data
const collectionPageSchema = {
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "DadDeck Card Collection",
  "url": collectionPageURL,
  "description": "Personal trading card collection viewer for DadDeck - the White Dad Trading Card Simulator",
  "about": {
    "@type": "Thing",
    "name": "Trading Cards",
    "description": "Collectible dad-themed trading cards"
  }
};
---

<BaseLayout
  title={title}
  description={description}
  image="/og-image.png"
>
  <Navigation client:load />
  <SettingsModal client:load />

  <!-- Page Header -->
  <div class="page-header">
    <div class="max-w-6xl mx-auto px-4 py-12 text-center">
      <h1 class="text-4xl md:text-5xl font-black text-white mb-4">
        <span class="text-amber-400">My</span> Collection
      </h1>
      <p class="text-slate-400 text-lg">
        All the dad cards you've collected
      </p>
    </div>
  </div>

  <!-- Collection Manager -->
  <div class="manager-section">
    <ErrorBoundary
      fallbackTitle="Collection Manager Error"
      fallbackMessage="We couldn't load the collection manager. Please refresh the page."
    >
      <CollectionManager client:load />
    </ErrorBoundary>
  </div>

  <!-- Collection Stats -->
  <div class="stats-section">
    <CollectionStats client:load />
  </div>

  <!-- Pack History -->
  <div class="history-section">
    <PackHistoryPanel client:load />
  </div>

  <!-- Gallery -->
  <main id="main-content" class="collection-main" tabindex="-1" role="main" aria-label="Card collection gallery">
    <Gallery client:load />
  </main>

  <!-- Structured data for collection page -->
  <script type="application/ld+json" set:html={JSON.stringify(collectionPageSchema)} />
</BaseLayout>

<style>
  .page-header {
    background: linear-gradient(to bottom, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.6));
    border-bottom: 1px solid rgba(71, 85, 105, 0.2);
  }

  .collection-main {
    min-height: calc(100vh - 200px);
    background: radial-gradient(ellipse at top, rgba(251, 191, 36, 0.05) 0%, transparent 50%),
                linear-gradient(to bottom, #0f172a, #1e293b);
  }

  .stats-section {
    padding: 0 1rem 2rem 1rem;
  }

  .history-section {
    padding: 0 1rem 2rem 1rem;
    background: radial-gradient(ellipse at top, rgba(168, 85, 247, 0.05) 0%, transparent 50%);
  }

  .manager-section {
    padding: 0 1rem 1rem 1rem;
  }
</style>
